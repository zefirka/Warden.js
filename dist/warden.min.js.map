{"version":3,"sources":["warden.js"],"names":["root","init","exports","module","Warden","define","amd","this","a","b","extend","is","exist","jQueryInited","jQuery","version","configure","history","cmp","x","y","each","arr","fn","i","l","length","forWhile","preventValue","depreventValue","undefined","filter","filtered","index","push","reduce","res","map","mapped","e","some","every","truthy","typeIs","n","trim","str","replace","not","predicate","toArray","obj","Object","keys","Array","prototype","slice","call","_extend","origin","add","_OBJ","arguments","dest","src","Pipeline","proc","host","tick","event","breaked","processes","self","fin","apply","ctx","fns","locked","next","data","stop","pause","play","pipe","p","start","context","Utils","_FUN","_NUM","_STR","_ARR","_BOOL","_UND","array","isArray","num","bool","equals","hashc","hash","get","set","parseInt","toString","clean","interpolate","argc","argv","reg","getObject","arg","JSON","stringify","s","split","elem","cand","Queue","max","oldpush","last","shift","$hash","isRegExp","test","_Array","v","bind","name","val","defineProperty","configurable","enumerable","writable","value","nativeListener","alternativeListener","defaultConfig","arrays","names","emit","listen","stream","unlisten","emitter","listener","ghandlers","setHandlers","id","handler","getHandlers","conf","binder","handlers","callback","type","config","Error","setval","c","inheritor","isConstructor","constStream","Stream","watch","fire","create","setTimeout","timeout","interval","setInterval","clearInterval","prev","current","overwrite","ev","callbacks","types","reactor","RegExp","indexes","splice","cnt","seval","inheritFrom","child","parent","children","process","pipes","$$id","newPipe","line","$$context","$$obs","fires","takes","valueOf","bindTo","binding","Watcher","concat","exec","result","mute","clear","log","console","grep","mapper","expression","match","eval","functor","decide","expr","subExpr","getter","getF","prop","reduced","take","bus","limit","taken","skip","skips","mask","o","diff","compractor","cons","debounce","t","clearTimeout","dbtimer","collect","tmpCollection","timer","collection","filterFor","collectFor","delay","time","toggle","toggled","after","flush","busExecuted","repeat","times","cached","waitFor","merge","toMerge","alternately","queue","resolve","sync","combine","seed","nbus","values","executions","unshift","state","swap","toggleOn","lock","lockThis","unlockThis","unlock","addToStream","piped","isStream","strict","xstr","reserved","hasOwnProperty","indexOf","error","st","update","remove","Formula","deps","formula","formulaStream","formulaValue"],"mappings":"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","file":"warden.min.js","sourcesContent":["((function (root, init) {\n  if (typeof exports === \"object\" && exports) {\n    module.exports = init(); // CommonJS\n  } else {\n    var Warden = init();\n    if (typeof define === \"function\" && define.amd) {\n      define(Warden); // AMD\n    } else {\n      root.Warden = Warden; // <script>\n    }\n  }\n})(this, function(){\n  'use strict';\n  var Warden = function(a, b){\n    return Warden.extend(is.exist(a) ? a : {}, b);\n  }\n  var jQueryInited = typeof jQuery != \"undefined\";\n\n  Warden.version = \"0.4.3\";\n  Warden.configure = {\n    history : 3,\n    cmp : function(x,y){ return x === y; }\n  };\n\n  (function(){\n    /* Globals */\n    var Utils,\n        _FUN = 'function',\n        _NUM = 'number',\n        _STR = 'string',\n        _OBJ = 'object',\n        _ARR = 'array',\n        _BOOL = 'boolean',\n        _UND = 'undefined';\n    \n    function each(arr, fn){ \n      for(var i=0, l=arr.length; i<l;i++){ \n        fn(arr[i], i);\n      }\n    }\n    \n    function forWhile(arr, fn, preventValue, depreventValue){\n      preventValue = preventValue || false; \n      for(var i=0, l=arr.length; i<l;i++){ \n        if(fn(arr[i], i) === preventValue){\n          return preventValue;\n        }\n      }\n      return depreventValue !== undefined ? depreventValue : true;\n    }\n    \n    function filter(arr, fn){\n      var filtered = [];\n      each(arr, function(i, index){\n        if(fn(i, index)===true){\n          filtered.push(i);\n        }\n      });\n      return filtered;\n    }\n    \n    function reduce(arr, fn){\n      var res = arr[0];\n      for(var i=1,l=arr.length;i<l;i++){\n        res = fn(res, arr[i]);\n      }\n      return res;\n    }\n    \n    function map(arr, fn){\n      var mapped = [];\n      each(arr, function(e, i){\n        mapped[i] = fn(e, i);\n      });\n      return mapped;\n    }\n    \n    function some(arr, fn){\n      return forWhile(arr, fn, true, false);\n    }\n    \n    function every(arr, fn){\n      return forWhile(arr, fn);\n    }\n    \n    function truthy(x){\n      return x ? true : false;\n    }\n    \n    function typeIs(n){\n      return function(x){\n        return typeof x === n;\n      }\n    }\n    \n    function trim(str){\n      return str.replace(/^\\s+|\\s+$/g, '')\n    }\n    \n    function not(predicate){\n      return function(x){\n        return !predicate(x);\n      }\n    }\n    \n    var is = {\n      exist : function(x){\n        return typeof x != _UND && x !== null;\n      },\n      array : function(x){\n        return Array.isArray(x)\n      },\n      fn : typeIs(_FUN),\n      num : typeIs(_NUM),\n      str : typeIs(_STR),\n      bool : typeIs(_BOOL),\n      equals : function(x){\n        return function(y){\n          return x === y;\n        }\n      }\n    }\n    \n    is.obj = function(x){\n      return typeIs(_OBJ)(x) && !is.array(x);\n    }\n    \n    function toArray(a){\n      if(is.obj(a) && !is.exist(a.length)){\n        a.length = Object.keys(a).length;\n      }\n      return Array.prototype.slice.call(a);\n    }\n    \n    /* Extending objects (not deep extend) */\n    function extend() {\n      function _extend(origin, add) {\n        if (!add || typeof add !== _OBJ) return origin;\n        var keys = Object.keys(add), i = keys.length;\n    \n        while (i--) {\n          origin[keys[i]] = add[keys[i]];\n        }\n        return origin;\n      }\n    \n      return reduce(toArray(arguments),function(dest, src) {\n        return _extend(dest, src);\n      });\n    }\n    \n    var hashc = (function(){\n      var hash = {};\n      return {\n        get : function(n){\n          return hash[n];\n        },\n        set : function(i){\n          return hash[i] = ((parseInt(hash[i], 16) || 0 )+1) . toString(16);\n        },\n        clean: function(i){\n          delete hash[i];\n        }\n      }\n    })();\n    \n    Utils = {\n          /* \n            Data type and logical statements checking methods\n          */\n        is : is,\n        not: not,\n    \n        /* \n          Array.prototype functional methods: \n        */ \n        forWhile : forWhile,\n        each : each, // synonym of forEach\n        filter : filter,\n        some : some,\n        every : every,\n        map : map,\n        reduce : reduce,\n        toArray: toArray,\n        /* Interpolation */\n        interpolate : function(str){\n          var data = {},\n              argc = arguments.length,\n              argv = Utils.toArray(arguments),\n              reg = /{{\\s*[\\w\\.\\/\\[\\]]+\\s*}}/g;\n    \n          if(argc==2 && is.obj(argv[1])){\n            data = argv[1];\n          }else{\n            each(argv.slice(1, argc), function(e, i){\n              data[i] = e;\n            });\n          }       \n    \n          return str.replace(reg, function(i){\n            var res = Utils.getObject(data, i.slice(2,-2)),\n                arg = is.exist(res) ? res : i;\n            if(is.obj(arg)){\n              arg=JSON.stringify(arg);\n            }          \n            return arg;\n          });\n        }, \n    \n        extend: extend,\n        trim: trim,\n    \n        getObject : function(data, s){\n          if(!is.obj(data)){\n            return data;\n          }\n    \n          each(s.split('/'), function(elem){\n            if(!is.exist(data)){\n              return data;\n            }\n    \n            var cand;\n    \n            if(elem[0]=='[' && elem[elem.length-1]==']'){\n              cand = elem.slice(1,-1);\n              if(is.exist(cand)){\n                if(is.num(parseInt(cand))){\n                  elem = parseInt(cand);\n                }else{\n                  throw \"Wrong syntax\";\n                }\n              }\n            }else{\n              if(!is.exist(data[elem])){\n                data = {}\n              }\n            }\n    \n            data=data[elem];\n    \n          });\n          return data;\n        },\n    \n        /* \n          Queue class @arr is Array, @maxlength is Number\n        */\n        Queue : function Queue(max, arr){\n          var res = arr || [],\n              max = max || 16,\n              oldpush = res.push;\n          \n          res.last = function(){\n            return res[res.length-1];\n          };\n          \n          res.push = function(x){\n            if(this.length>=max){\n              this.shift();\n            }\n            return oldpush.apply(res, [x]);\n          }\n          return res;\n        },\n    \n        $hash : hashc\n      }\n    \n      Warden.Utils = Utils;\n    /* This methods extends @obj which can be function, object or array with Warden.js methods .emit(), .listen(), .unlisten() and .stream() */\n    Warden.extend = (function(){\n      var nativeListener = \"addEventListener\",\n          alternativeListener = \"attachEvent\",\n    \n        defaultConfig = {\n          arrays : ['pop', 'push', 'splice', 'reverse', 'shift', 'unshift', 'sort'], //only not-pure methods\n          names : {\n            emit : 'emit',\n            listen : 'listen',\n            stream : 'stream',\n            unlisten : 'unlisten'\n          },\n          emitter : null, /* custom event emitter if exists */\n          listener : null /* custrom event listener if exists */\n        },\n    \n        ghandlers = {}, //global storage for handlers\n    \n        setHandlers = function(id){\n          ghandlers[id] = ghandlers[id] || [];\n          each(toArray(arguments).slice(1), function(handler){\n            ghandlers[id].push(handler);\n          });\n        },\n    \n        getHandlers = function(id){\n          return ghandlers[id] || [];\n        }\n    \n        function isRegExp(str){\n          return /.?[\\*\\[\\]\\{\\}\\.\\?\\$\\^\\\\\\|].?/g.test(str);\n        }\n      \n      function _Array(arr){\n        each(arr, function(v, i){\n          this[i] = v;\n        }.bind(this));\n      }\n    \n      function define(obj, name, val){\n        Object.defineProperty(obj, name, {\n          configurable: false,\n          enumerable: false,\n          writable: false,\n          value: val \n        })\n      }\n    \n      return function(obj, conf) {\n        function binder (fn, handlers, callback){\n          return function(type){\n            var self = this;\n    \n            if(every(handlers, function(i){return is.str(type) ? i.type == type : i.type.test(type)}) && self[config.listener]){\n              if(!is.str(type)){\n                throw new Error(\"Invalid format in: \" + config.listener);\n              }\n              this[config.listener].apply(this, [type, function(event){\n                fn.call(self, event)\n              }]);\n            }\n    \n            setHandlers(self['$$id'], {\n              type: type,\n              callback: callback\n            });\n          }\n        }\n    \n        function setval(a, b, c){\n         a[b] = c;\n        }\n    \n        var config = extend({}, defaultConfig, conf || {}), // default configuration\n            inheritor = is.exist(obj) ? obj : {}, // final object to extend\n            isConstructor = true, //obj is constructor\n            names = config.names;\n    \n        /*\n          Choose object to extend,\n          if fn is constructor function, then that's prototype, else\n          use actual object element\n        */\n        if(is.fn(obj)){\n          inheritor = obj.prototype;\n        }else\n        if(typeof obj !== _OBJ){\n          var constStream = Warden.Stream().watch();\n          constStream.fire(obj);\n          return constStream;\n        }else{\n          isConstructor = false;\n    \n          if(is.array(obj)){\n            /* Extending methods of a current array with stream evaluation */\n    \n            _Array.prototype = Object.create(inheritor);\n    \n            define(_Array.prototype, 'repeatedly', function(){\n              var self = this, l = self.length;\n    \n              return Warden.Stream(function(fire){            \n                var i = 0;\n                setTimeout(function(){\n                  while(i < l){\n                    fire(self[i++])\n                  }\n                });            \n              });\n            });\n    \n            define(_Array.prototype, 'sequentially', function(timeout){\n              var self = this, l = self.length;\n    \n              return Warden.Stream(function(fire){\n                var i = 0,\n                \n                interval = setInterval(function(){\n                  if(i<l){\n                    fire(self[i]);\n                    i++;\n                  }else{\n                    i = 0;\n                    clearInterval(interval);\n                  }\n    \n                }, timeout);\n              });\n            });\n    \n            each(config.arrays, function(name){\n              define(_Array.prototype, name, function(){ \n                var prev = this;\n                Array.prototype[name].apply(this, arguments);\n                this.emit({\n                  type: name,\n                  prev : prev,\n                  current: this,\n                  data: toArray(arguments)\n                });\n              });\n            });\n    \n            obj = new _Array(obj);\n            inheritor = _Array.prototype;\n    \n            setval = function(a,b,c){\n              return define(a,b,c);\n            }\n          }\n    \n        }\n    \n        var overwrite = inheritor[names.emit] || inheritor[names.listen] ||\n                        inheritor[names.unlisten] || inheritor[names.stream];\n    \n        /* Checking free namespace */\n        if(is.exist(overwrite)){\n          throw new Error(\"Can't overwrite: \" + (overwrite.name ? overwrite.name : overwrite) + \" of object\");\n        }\n    \n        /*\n          Setting up standart DOM event listener\n          and emitters  function to not overwrite them\n          and user should do not use that in config\n        */\n        if(jQueryInited && (!isConstructor ? obj instanceof jQuery : true)){\n          config.emitter = config.emitter || 'trigger';\n          config.listener = config.listener || 'on';\n        }else\n        if(is.fn(inheritor[nativeListener]) || is.fn(inheritor[alternativeListener])){\n          config.listener = config.listener || (is.fn(inheritor[nativeListener]) ? nativeListener : alternativeListener);\n        }\n    \n        /* Emitter method */\n        setval(inheritor, names.emit, function(ev, data){\n          var self = this,\n              type = is.str(ev) ? ev : ev.type,\n              data = is.obj(ev) ? ev : data || ev,\n              callbacks = filter(getHandlers(this['$$id'] = this['$$id'] || hashc.set('o')), function(i){\n                return is.str(i.type) ? i.type == type : i.type.test(type);\n              });\n    \n          each(callbacks, function(callback){\n            callback.callback.call(self, data);\n          });\n    \n          return this;\n        });\n    \n        /* Listen events of @type */\n        setval(inheritor, names.listen, function(types, callback){\n          var self = this,\n            reactor = binder(function(event){\n              this.emit(event);\n            }, getHandlers(this['$$id'] = this['$$id'] || hashc.set('o')), callback);\n    \n          each(types.split(','), function(type){\n            type = trim(type);\n            reactor.call(self, isRegExp(type) ? new RegExp(type) : type);\n          });\n    \n          return this;\n        });\n    \n        /* Unsubscribe from events of @type */\n        setval(inheritor, names.unlisten, function(type, name){\n          var self = this, \n              indexes = [], //to remove\n              type = trim(type),\n              handlers = getHandlers(this['$$id'] = this['$$id'] || hashc.set('o')); // link to object\n    \n          if(handlers.length){\n            \n            if(!name){\n              indexes = new Array(handlers.length);\n            }else{\n              each(handlers, function(handler, index){\n                if(handler.callback.name == (name.name || name) && handler.type.toString() == type.toString()){\n                  indexes.push(index);\n                }            \n              });\n            }\n    \n            each(indexes, function(i){\n              handlers.splice(i,1);\n            });\n          }\n          return this;\n        });\n    \n        /* Creates stream of @type type events*/\n        setval(inheritor, names.stream, function(types, cnt){\n          var self = this,\n              stream = Warden.Stream(null, cnt || this),\n              seval = function(event){\n                stream.fire(event, cnt || this)\n              },\n              reactor = binder(seval, getHandlers(this['$$id'] = this['$$id'] || hashc.set('o')), seval);\n          \n          each(types.split(','), function(type){\n            type = trim(type);\n            reactor.call(self, isRegExp(type) ? new RegExp(type) : type);\n          });\n    \n          return stream;\n        });\n    \n        return obj;\n      };\n    })();\n    function Pipeline(proc, host){\n      var processes = proc || [], locked = 0, i = 0,\n    \n          /* Functional methods to manipulate DataBus processing workflow */\n          fns = {\n            /* Continue processing with @data */\n            next: function(data){\n               return tick(data);\n            },\n            /* Break processing */\n            stop: function(){\n              return i=0;\n            },\n            /* Locks DataBus evaluation */\n            pause: function(){\n              return locked = 1;\n            },\n            /* Unlocks DataBus evaluation */\n            play: function(){\n              return locked = 0;\n            },\n            /* Returns current DataBus */\n            host: function(){\n              return host;\n            }\n          };\n    \n              /* Ticking processor to the next process */\n      function tick(event, breaked){\n        if(breaked){\n          return i = 0;\n        }\n    \n        if(i==processes.length){\n          i = 0;\n          return self.fin(event);\n        }\n    \n        i++;\n        processes[i-1].apply(self.ctx, [event, fns]);\n    \n      }\n    \n      var self = {\n        /* Add process if @p exists or return all processes of this Processor */\n        pipe : function(p){\n          if(p){\n            processes.push(p)\n            return self;\n          } \n          return processes;\n        },\n    \n        /* Start processing */\n        start : function(event, context, fin){\n          self.ctx = context;\n          self.fin = fin;\n    \n          i = locked ? 0 : i;\n    \n          if(i==processes.length){\n            i = 0;\n            return fin(event);\n          }\n    \n          tick(event);\n        }\n      }\n      return self;\n    }\n    \n    Warden.Pipeline = Pipeline\n    var Stream = (function(){\n      var handlers = {},\n          pipes = {};\n    \n      function inheritFrom(child, parent){\n        child.parent = parent;\n        parent.children.push(child);\n        return child;\n      }\n    \n      /* Clones Stream */\n      function process(p){\n        var pipe = pipes[this.$$id],\n            newPipe = pipe.pipe().slice();\n        \n        newPipe.push(p);\n    \n        return inheritFrom(new Stream(newPipe), this);\n      }\n    \n      function Stream(line, context){\n        var max = Warden.configure.history;\n    \n        this.$$id = Utils.$hash.set('d');\n        this.$$context = context || {};\n        this.$$obs = false;\n    \n        this.parent = null;\n        this.children = [];\n    \n        handlers[this.$$id] = [];\n        pipes[this.$$id] = Pipeline(line || [], this);\n    \n        this.data = {\n          fires : new Utils.Queue(max),\n          takes : new Utils.Queue(max),\n          last : null\n        };   \n      }\n    \n      Stream.prototype = {\n        valueOf : function(e){\n          return this.data.last;\n        },\n    \n        toString : function(e){\n          return this.data.last.toString();\n        },\n    \n        bindTo : function() {\n          var binding = Warden.Watcher.apply(null, [this].concat(toArray(arguments)));\n          return binding;\n        },\n    \n        exec : function(data, context) {\n          if(!this.$$obs){\n            return;\n          }\n    \n          var id = this.$$id, self = this;\n    \n          this.data.fires.push(data); // pushing fired data to @fires queue\n    \n          pipes[id].start(data, context, function(result){\n            self.data.takes.push(result); // pushing taked data to @takes queue\n            self.data.last = result;\n            /* Executing all handlers of this Stream */\n            each(handlers[id], function(handler){\n              handler.call(context, result);\n            });\n          });\n        },\n    \n        fire : function(data, context) {\n          if(this.locked){\n            return;\n          }\n    \n          context = context || this.$$context;\n    \n          if(!this.$$obs){\n            each(this.children, function(child){\n              child.fire(data, context);\n            })\n            return;\n          }\n    \n          this.exec(data, context);\n          each(this.children, function(child){\n            child.fire(data, context);\n          });\n        },\n    \n        /*\n          Binds a handler @x (if @x is function) or function that logging @x to console (if @x is string) to the current Stream\n    \n          This function don't create new Stream object it just puts to the current data bus\n          object's handlers list new handler and push it's to the executable pipe of hoster stream\n        */\n        listen : function(x){\n          this.$$obs = true;\n          handlers[this.$$id].push(x);      \n          return this;\n        },\n    \n        watch : function(){    \n          this.$$obs = true;\n          return this;\n        },\n          \n        /*\n          Unbinds handler with name @x (if @x is string) or @x handler (if @x is function)\n          If in the handlers list 2 or more handlers with name @x (or @x handlers registered twice) it will remove all handlers\n        */\n        mute : function(x){\n          var self = this;\n          Utils.forWhile(handlers[this.$$id], function(handler, index){\n            if(is.fn(x) ? (handler == x) : handler.name == x){\n              handlers[self.$$id].splice(index, 1);\n              return false;\n            }\n          }, false);\n    \n          return this;\n        },\n    \n        clear : function(){\n          handlers[this.$$id] = [];\n        },\n    \n        /* Logging recieved data to console or logger */\n        log : function(x){\n          return this.listen(function log(data){\n            console.log(x ? x.replace(/\\$/g, data) : data);\n          });\n        },\n    \n        /*\n          Filtering recieved data and preventing transmitting through Stream if @x(event) is false\n        */\n        filter : function(x) {\n          if(is.fn(x)){\n            return process.call(this, function(e, pipe){\n              return x.call(this, e) === true ? pipe.next(e) : pipe.stop();\n            });\n          }else{\n            return process.call(this, function(e, pipe){\n              return Warden.configure.cmp(x, e) === true ? pipe.next(e) : pipe.stop();\n            });\n          }\n        },\n    \n        /*\n          Mapping recieved data and transmit mapped to the next processor\n        */\n        map : function(x) {\n          return process.call(this, function(event, pipe){\n            if(is.fn(x)){\n              pipe.next(x.call(this, event));\n            }else{\n              pipe.next(x);\n            }\n          });\n        },\n    \n        grep: function(mapper){\n          // \n          function grep(str, event){\n            if(str[0] == '.'){\n              str = \"$\" + str;\n            }\n    \n            var expression = str.replace(/\\$/g, 'event').replace(/^@$/g, \"this\").replace(/^@/g, 'this.').replace(/@/g, 'this');\n    \n            if(str.match(/[\\$\\@\\.]/g)){\n              return eval(expression);\n            }else{\n              return expression;\n            }\n          }\n    \n          // functior of simple types\n          function functor(x){\n            if(!is.str(x)){\n              return function(){\n                return x;\n              }\n            }else\n            if(is.fn(x)){\n              return function(event){\n                return x.call(ctx, event);\n              }\n            }else{\n              return function(event){\n                return grep.call(this, x, event);\n              }\n            }\n          }\n    \n          function decide(expr){\n            var res = null;\n    \n            if(is.array(expr)){\n              res = map(expr, function(subExpr){\n                return decide(subExpr);\n              });\n            }else\n            if(is.obj(expr)){\n              res = {};\n              for(var i in expr){\n                res[i] = decide(expr[i]);\n              }\n            }else{\n              res = functor(expr);\n            }\n    \n            return res;\n          }\n    \n          function apply(event, getter, ctx){\n            if(is.array(getter)){\n              return getter.map(function(getF){\n                return apply(event, getF, ctx);\n              });\n            }\n    \n            if(is.obj(getter)){\n              var res = {};\n              for(var prop in getter){\n                res[prop] = apply(event, getter[prop], ctx)\n              }\n              return res;\n            }\n    \n            return getter.call(ctx, event);\n          }\n    \n          var getter = decide(mapper);\n    \n          return process.call(this, function(event, pipe){\n            pipe.next(apply.call(this, event, getter, this));\n          })\n    \n        },\n    \n        /*\n          Appying @fn function ot the previos and current value of recieved data\n          If previous value is empty, then it is init or first value (or when init == 'first' or '-f')\n        */\n        reduce : function(init, fn){\n          var reduced = new Utils.Queue(1);\n          return process.call(this, function(event, pipe){\n            \n            var bus = pipe.host(),\n                res;\n            if(reduced.length == 0){\n              res = fn ? fn.call(this, init, event) : event;\n            }else{\n              res = (fn || init).call(this, reduced[reduced.length-1], event);\n            }\n            reduced.push(res);\n            return pipe.next(res);\n          });\n        },\n    \n        /*\n          Take only @x count or (if @x is function) works like .filter()\n        */\n        take : function(x){\n          return process.call(this, function(e, pipe){\n            var bus = pipe.host();\n            bus.data.limit = bus.data.limit || x;\n            bus.data.taken = (bus.data.taken + 1) || 0;\n            return bus.data.taken >= bus.data.limit ? pipe.stop() : pipe.next(e);\n          });\n        },\n    \n    \n        /*\n          Skips data [Integer] @c times\n        */\n        skip : function(c) {\n          var self = this;\n          return process.call(this, function(e, pipe){\n            self.skips = self.skips || 0;\n            if(self.skips == c){\n              delete self.skips;\n              pipe.next(e)\n            }else{\n              self.skips += 1;\n              pipe.stop();\n            }\n          });\n        },\n    \n        /*\n          Interpolates to the [String] @s data from bus (all matches of [RegExp] @reg or {{match}}-style regex)\n        */\n        interpolate : function(s){\n          return process.call(this, function(event, pipe){\n            return pipe.next(Utils.interpolate(s, event))\n          })\n        },\n    \n        /*\n          Masking data from bus with [Object] @o (all matches of [RegExp] @reg or {{match}}-style regex)\n        */\n        mask : function(o){\n          return process.call(this, function(event, pipe){\n            return pipe.next(is.str(event) ? Utils.interpolate(event, o) : event);\n          });\n        },\n    \n        /*\n          Transfers only unique datas through bus.\n          [Function] @cmp - is comparing method that returns\n          [Boolean] 'true' if first argument of @cmp is equals to second argument\n    \n          By default: @cmp compares arguments with === operator\n        */\n        diff : function(compractor){\n          compractor = compractor || Warden.configure.cmp;\n    \n          return process.call(this, function(event, pipe){\n            var data = pipe.host().data, fires = data.fires, takes = data.takes,\n                cons = (fires.length > 1 || takes.length > 0) && (compractor(event, fires[fires.length-2]) || compractor(event, takes.last()));\n              return cons ? pipe.stop() : pipe.next(event);\n          });\n        },\n    \n        pipe : function(fn){\n          return process.call(this, function(event, pipe){\n            fn(event, pipe.next.bind(pipe));\n          });\n        },\n    \n        /*\n          Debounce data bus on [Integer] @t miliseconds\n        */\n        debounce : function(t) {\n          return process.call(this, function(e, pipe){\n            var self = this, bus = pipe.host();\n            clearTimeout(bus.data.dbtimer);\n            bus.data.dbtimer = setTimeout(function(){\n              delete bus.data.dbtimer;\n              pipe.play();\n              pipe.next(e);\n            }, t);\n            pipe.pause();\n          });\n        },\n    \n        /*\n          Collecting events for [Integer] @t miliseconds and after it transmitting an array of them\n        */\n        collect : function(t){\n          return process.call(this, function(e, pipe){\n            var self = this,\n                bus = pipe.host(),\n                fired = bus.data.fires.length-1;\n            bus.data.tmpCollection = bus.data.tmpCollection || [];\n            bus.data.tmpCollection.push(e);\n            if(!bus.data.timer){\n              bus.data.timer = setTimeout(function(){\n                var collection = bus.data.tmpCollection;\n    \n                clearTimeout(bus.data.timer);\n                delete bus.data.timer;\n                delete bus.data.tmpCollection\n    \n                pipe.play();\n                pipe.next(collection);\n              }, t);\n              pipe.pause();\n            }else{\n              pipe.pause();\n            }\n          });\n        },\n    \n        filterFor : function(fn) {\n          var data;\n          return process.call(this, function(e, pipe){\n            var pipes = {\n              get : function(fn){\n                return fn ? fn(data) : data;\n              },\n              next: function(e, fn){\n                data = fn ? fn(data, e) : e;\n                pipe.next(e);\n              },\n    \n              stop: function(e){\n                pipe.stop();\n              }\n            }\n            return fn(e, pipes);\n          });\n        },\n    \n        collectFor : function(bus){\n          var collection = [];\n    \n          this.listen(function(e){\n            collection.push(e);\n          });\n    \n          return Warden.Stream(function(emit){\n            bus.listen(function(){\n              emit(collection);\n              collection = [];\n            })\n          });\n        },\n                                                                                                                            \n        delay : function(time) {\n          return process.call(this, function(e, pipe){\n            setTimeout(function(){\n              pipe.next(e)\n            }, time);\n          });\n        },\n    \n        toggle : function(a,b) {\n          var toggled = false;\n          \n          return this.listen(function(data){\n            if(toggled){\n              b.call(this, data);\n            }else{\n              a.call(this, data);\n            }\n            toggled = !toggled;\n          });\n        },\n    \n        after : function(bus, flush){\n          var busExecuted = false;\n    \n          bus.listen(function(){\n            busExecuted = true;\n          });\n    \n          return process.call(this, function(event, pipe){\n            if(busExecuted){\n              busExecuted = flush === true ? false : true;\n              pipe.play();\n              pipe.next(event);\n            }else{\n              pipe.pause();\n            }\n          });\n        },\n    \n        repeat : function(times, delay){\n          var self = this,\n              cached = times;\n    \n          return inheritFrom(Warden.Stream(function(emit){\n            self.listen(function(data){\n              var interval = setInterval(function(){\n                if(times){\n                  emit(data);\n                  times--\n                }else{\n                  times = cached;\n                  clearInterval(interval);\n                }\n              }, delay);\n            });\n          }), this);\n        },\n    \n        waitFor : function(bus){\n          var self = this;\n          return Warden.Stream(function(emit){\n            var exec = false, val,\n                clear = function(){\n                  val = null;\n                  exec = false;\n                };\n    \n            bus.listen(function(data){\n              if(exec){\n                emit(val);\n                clear();\n              }\n            });\n    \n            self.listen(function(data){\n              val = data;\n              exec = true;\n            });\n    \n          }).host();\n        },\n    \n        /*\n          Usage: bus.merge(bus1, [bus2] ... [busN])\n          Merges @bus with buses from arguments\n        */\n        merge : function(){\n          var stream = Warden.Stream(this.$$id, this.$$context),\n              argv = toArray(arguments);\n              argv.push(this);\n    \n          each(argv, function(toMerge){\n            toMerge.listen(function(data){\n              stream.fire(data);\n            });\n          });      \n    \n          return stream;\n        },\n    \n        alternately : function(bus){\n          var self = this,\n              queue = 0; // 0 - this, 1 - bus\n    \n          return Warden.Stream(function(fire){\n            self.listen(function(e){\n              if(queue==0){\n                fire(e)\n                queue = 1;\n              }\n            });\n            bus.listen(function(e){\n              if(queue==1){\n                fire(e);\n                queue = 0;\n              }\n            });\n          })\n    \n        },\n    \n        resolve : function(stream, fn, ctx) {\n          var self = this;\n          return Warden.Stream(function(emit){\n            self.sync(stream).listen(function(data){\n              emit(fn.call(ctx, data[0], data[1]));\n            });\n          }, ctx || this.$$context);\n        },\n    \n        /* Combines two bises with given function @fn*/\n        combine : function(bus, fn, seed){\n          var self = this;\n    \n          return Warden.Stream(function(emit){\n            function e(a,b){\n              emit(fn.call(self.$$context, a,b));\n            }\n    \n            self.listen(function(data){\n              e(data, bus.data.last || seed);\n            });\n            bus.listen(function(data){\n              e(self.data.last || seed, data);\n            });\n    \n          }, this.$$context);\n        },\n    \n        /* Synchronizes  buses */\n        sync : function(){\n          var self = this,\n              argv = toArray(arguments),\n              values = [],\n              executions = [],\n              nbus;\n    \n          argv.unshift(this);\n    \n          values.length = executions.length = argv.length;\n    \n          nbus = Warden.Stream(function(emit){\n            each(argv, function(bus, index){\n              bus.listen(function(data){\n                var exec = executions.length ? true : false;\n    \n                Utils.forWhile(executions, function(state, i){\n                  if(i == index){\n                    return true;\n                  }\n                  if(!state){\n                    exec = false;\n                  }\n                  return state;\n                }, false);\n    \n                values[index] = data;\n    \n                if(exec){\n                  emit(values);\n                  values = [];\n                  executions = [];\n                  values.length = executions.length = argv.length;\n                }else{\n                  executions[index] = true;\n                }\n    \n              });\n            });\n          });\n          \n          return nbus;\n        },\n        \n        stream : function(){\n          return inheritFrom(new Stream(), this);\n        },\n    \n        swap : function(state){\n          var self = this;\n    \n          function swap(e, val){\n            e.locked = !val;\n            each(e.children, function(child){\n              child.swap(val);\n            });\n          }\n    \n          swap(this, state);      \n        },\n        \n        toggleOn: function(bus, state){\n          var self = this;\n          if(bus instanceof Stream){\n            bus.listen(function(){\n              self.swap(state);\n            });\n          }\n        },\n    \n        /* Lock/unlock methods */\n        lock : function(bus){\n          this.swap(false);\n          if(bus){\n            this.toggleOn(bus, false);\n          }\n          return this;\n        },\n    \n        lockThis : function() {\n          this.locked = true;\n          return this;\n        },\n    \n        unlockThis : function(){\n          this.locked = false;\n          return this;\n        },\n    \n        unlock : function(bus){\n          this.swap(true);\n          if(bus){\n            this.toggleOn(bus, true);\n          }\n          return this;\n        }\n      }\n    \n      Object.defineProperty(Stream.prototype, 'value', {\n        configurable: true,\n        get : function(){\n          return this.data.last;\n        },\n        set : function(v){\n          this.fire(v);\n        }\n      });\n    \n      Warden.configure.addToStream = function(name, fn, piped){\n        Stream.prototype[name] = function() {\n          var self = this,\n              argv = arguments;\n          if(!piped){\n            return process.call(this, fn.apply(this, arguments));\n          }else{\n            return fn.apply(this, arguments);\n          }\n        };\n      }\n    \n      Warden.configure.isStream = function(e){\n        return (e instanceof Stream);\n      }\n    \n      return Stream;\n    })();\n    \n    \n    Warden.Stream = function(x, context, strict){\n      var stream, xstr, reserved = [], i, bus;    \n          context = context || {};  \n          stream = new Stream([], context);\n    \n      if(is.fn(x)){\n        /* If we strict in context */\n        if(strict===true){\n          xstr = x.toString();\n    \n          for(i in context){\n            if(context.hasOwnProperty(i))\n              reserved.push(i);\n          }\n    \n          if(reserved.length){\n            each(reserved, function(prop){\n              if(xstr.indexOf(\"this.\"+prop)>=0){\n                /* If there is a coincidence, we warn about it */\n                console.error(\"Coincidence: property: '\" + prop + \"' is already defined in stream context!\", context);\n              }\n            });    \n          }\n        }\n    \n        x.call(context, function(result, ctx){\n          stream.fire(result, ctx);\n        });  \n      }\n    \n      return stream;\n    }\n    Warden.Watcher = function(){\n    \tvar argv = Utils.toArray(arguments).slice(1,arguments.length),\n    \t\targc = argv.length,\n    \t\tbus = arguments[0],\n    \t\ta = argv[0],\n    \t\tb = argv[1],\n    \t\tfn,\n    \t\tst;\n    \n    \tif(argc===1){\n    \t\tif(is.str(a)){\n    \t\t\tfn = function binding(event){this[a] = event;}\t\t\t\n    \t\t}else\t\n    \t\tif(is.fn(a)){\n    \t\t\tfn = function binding(event){a(event);}\n    \t\t}\n    \t}else{\n    \t\tif(is.obj(a) && is.str(b)){\n    \t\t\tif(b.indexOf('/')>=0){\n    \t\t\t\tvar dest = \"\";\n    \n    \t\t\t\teach(b.split('/'), function(name){\n    \t\t\t\t\tif(!is.exist(eval(\"a\" + dest)[name])){\n    \t\t\t\t\t\tthrow \"Unknown property: \" + name + \" from chain: \" + b;\n    \t\t\t\t\t}\n    \t\t\t\t\tdest += ('[\"'+name+'\"]');\n    \t\t\t\t});\n    \n    \t\t\t\tfn = function binding(event){\n    \t\t\t\t\teval(\"a\" + dest + \"= event\");\n    \t\t\t\t}\n    \t\t\t}else{\n    \t\t\t\tfn = is.fn(a[b]) ? function binding(event){a[b](event);} : fn = function binding(event){a[b] = event} ;\n    \t\t\t}\n    \t\t}else\n    \t\tif(is.fn(b)){\n    \t\t\tfn = function binding(event){b.call(a, event);}\n    \t\t} \n    \t}\n    \n    \tst = fn;\n    \n    \tbus.listen(fn);\n    \n    \treturn {\n    \t\tupdate: fn,\n    \t\tremove: function(){\n    \t\t\tbus.mute('binding');\n    \t\t}\n    \t}\n    };\n    Warden.Formula = function(deps, formula, ctx){\n      var formulaStream = Warden.Stream(formula.toString(), ctx || {});\n    \n      each(deps, function(stream){\n        stream.listen(function(data){\n          var formulaValue = formula.apply(ctx || this, deps);\n    \n          formulaStream.fire(formulaValue);\n        });\n      });\n      \n      formulaStream.watch();\n    \n      formulaStream.value = formula.apply(ctx, deps);\n      \n      return formulaStream\n    }\n  })();\n\n  if(jQueryInited){\n    Warden(jQuery);\n  }\n\n  return Warden;\n\n}));\n"],"sourceRoot":"/source/"}